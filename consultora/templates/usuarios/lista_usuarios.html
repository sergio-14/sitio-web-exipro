{% extends "base.html" %} {% block content %}
<div class="w-full px-4 md:px-12 py-6">
  <h2 class="text-3xl text-cyan-600 font-primary mb-6">Lista de Usuarios</h2>

  <div class="flex flex-col md:flex-row justify-between items-end gap-4 mb-6">
    <form method="get" class="flex flex-col sm:flex-row gap-2 w-full md:w-3/4">
      <input
        type="text"
        name="q"
        placeholder="Buscar por nombre o apellido"
        value="{{ query|default:'' }}"
        class="w-full px-3 py-2 rounded-lg border border-cyan-300/10 focus:outline-none focus:ring-2 focus:ring-cyan-500/20 dark:bg-slate-950 dark:text-white"
      />
      <div class="flex gap-2">
        <button
          type="submit"
          class="bg-green-600 hover:bg-green-800 text-white px-4 py-2 rounded-sm font-semibold"
        >
          Buscar
        </button>
        <a
          href="{% url 'lista_usuarios' %}"
          class="px-4 py-2 rounded-sm border border-gray-300 text-gray-700 dark:text-white dark:border-gray-600 hover:bg-gray-200 dark:hover:bg-gray-700"
        >
          Limpiar
        </a>
      </div>
    </form>

    <div class="w-full md:w-auto mb-2">
      <a
        href="{% url 'agregar_usuario' %}"
        class="px-4 py-2 border border-blue-700/30 text-blue-900 hover:bg-blue-500 hover:text-white rounded-sm font-semibold block text-center md:inline"
      >
        Agregar Usuario
      </a>
    </div>
  </div>

  <div class="overflow-x-auto bg-white dark:bg-slate-900 rounded shadow">
    <table class="w-full text-sm text-left text-slate-600 dark:text-slate-300">
      <thead
        class="bg-slate-200 dark:bg-slate-800 text-xs uppercase font-semibold"
      >
        <tr>
          <th class="px-4 py-3">Foto</th>
          <th class="px-4 py-3">Email</th>
          <th class="px-4 py-3">Nombre</th>
          <th class="px-4 py-3">Teléfono</th>
          <th class="px-4 py-3">Dirección</th>
          <th class="px-4 py-3">Acciones</th>
        </tr>
      </thead>
      <tbody class="divide-y divide-slate-200 dark:divide-slate-700">
        {% for usuario in page_obj %}
        <tr class="hover:bg-slate-100 dark:hover:bg-slate-800">
          <td class="px-4 py-3">
            {% if usuario.imagen %}
            <img
              src="{{ usuario.imagen.url }}"
              alt="Foto de {{ usuario.nombre }}"
              class="w-12 h-12 object-cover rounded-full"
            />
            {% else %}
            <span class="text-slate-400 italic">Sin foto</span>
            {% endif %}
          </td>
          <td class="px-4 py-3">{{ usuario.email }}</td>
          <td class="px-4 py-3">
            {{ usuario.nombre }} {{ usuario.apellido }} {{ usuario.apellidoM }}
          </td>
          <td class="px-4 py-3">{{ usuario.telefono }}</td>
          <td class="px-4 py-3">{{ usuario.direccion }}</td>
          <td class="px-4 py-3 space-x-2">
            <a
              href="{% url 'editar_usuario' usuario.pk %}"
              class="bg-yellow-500 hover:bg-yellow-600 text-white px-3 py-1 rounded text-sm"
            >
              Editar
            </a>
            {% if usuario.is_active %}
            <a
              href="{% url 'deshabilitar_usuario' usuario.pk %}"
              onclick="return confirm('¿Estás seguro de deshabilitar este usuario?')"
              class="border border-red-500 text-red-500 hover:bg-red-500 hover:text-white px-3 py-1 rounded text-sm"
            >
              Deshabilitar
            </a>
            {% else %}
            <a
              href="{% url 'activar_usuario' usuario.pk %}"
              onclick="return confirm('¿Estás seguro de activar este usuario?')"
              class="border border-green-500 text-green-500 hover:bg-green-500 hover:text-white px-3 py-1 rounded text-sm"
            >
              Activar
            </a>
            {% endif %}
          </td>
        </tr>
        {% empty %}
        <tr>
          <td
            colspan="6"
            class="text-center text-slate-500 dark:text-slate-400 py-4"
          >
            No se encontraron usuarios.
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>

  <!-- Paginación -->
  <div class="mt-6 flex justify-center gap-4 items-center">
    {% if page_obj.has_previous %}
    <a
      href="?page={{ page_obj.previous_page_number }}{% if query %}&q={{ query }}{% endif %}"
      class="px-4 py-2 bg-slate-700 text-white rounded hover:bg-slate-800 text-sm"
    >
      &lsaquo; Anterior
    </a>
    {% endif %}
    <span class="text-sm text-slate-600 dark:text-slate-300"
      >Página {{ page_obj.number }} de {{ page_obj.paginator.num_pages }}</span
    >
    {% if page_obj.has_next %}
    <a
      href="?page={{ page_obj.next_page_number }}{% if query %}&q={{ query }}{% endif %}"
      class="px-4 py-2 bg-slate-700 text-white rounded hover:bg-slate-800 text-sm"
    >
      Siguiente &rsaquo;
    </a>
    {% endif %}
  </div>
</div>
{% endblock %}
